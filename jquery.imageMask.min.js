function isCanvasSupported(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}isCanvasSupported()&&!function(t){function i(i,e,a){var n=e.width,s=e.height;if(1==a)var n=i.width+"px",s=i.height+"px";i=t(i);var h;return h=i.attr("id")?i.attr("id"):r++,h="imageMask_"+h+"_canvas",t("<canvas>").attr({id:h,"class":i.attr("class"),style:i.attr("style"),width:n,height:s}).css("visibility","").insertAfter(i)}function e(t,i,e){i.drawImage(e,0,0,t.width,t.width);var a=i.getImageData(0,0,t.width,t.height);return i.clearRect(0,0,t.width,t.height),a}function a(t,i,e){var a=1;a=e.width>e.height?t.height/e.height:t.width/e.width,i.drawImage(e,0,0,e.width,e.height,0,0,e.width*a,e.height*a)}function n(t,i,e){for(var a=i.getImageData(0,0,t.width,t.height),n=0;n<a.data.length;n+=4)a.data[n+3]=e.data[n+3];i.putImageData(a,0,0)}var r=0;t.fn.imageMask=function(r,s,h){if(void 0==r)return console.error("imageMask: undefined mask"),!1;if(!this.is("img"))return console.error("imageMask: jQuery object MUST be an img element"),!1;if(void 0!=s&&!t.isFunction(s))return console.error("imageMask: callback MUST be function"),!1;var o=null;r.src?o=r:(o=new Image,o.crossOrigin="Anonymous",o.src=r);var c=this;return c.css("visibility","hidden"),t(o).load(function(){var r=null;c.each(function(){var c=t(this),d=null;d=i(this,o,h)[0];var g=d.getContext("2d"),u=new Image;u.crossOrigin="Anonymous",u.src=t(this).attr("src"),t(u).load(function(){r=e(d,g,o),a(d,g,u),n(d,g,r),c.remove(),t.isFunction(s)&&s(d)})})}),this}}(jQuery);