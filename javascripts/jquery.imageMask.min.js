/**
 * jQuery imageMask
 * @author Almog Baku - almog.baku@gmail.com
 * @see https://github.com/AlmogBaku/imageMask
 * 
 * @version 0.1b
 * @license MIT License
 */

(function(e){var j=0,d=null,g=null;e.fn.imageMask=function(h){if(void 0==h||!this.is("img"))return!1;var f;h.src?f=h:(f=new Image,f.src=h);var i=this;e(f).load(function(){i.each(function(){var c,a=f;c=e(this);var b;b=c.attr("id")?c.attr("id"):j++;b="imageMask_"+b+"_canvas";d=e("<canvas>").attr({id:b,"class":c.attr("class"),style:c.attr("style"),width:a.width,height:a.height}).insertAfter(c)[0];c=d.getContext("2d");null==g&&(c.drawImage(f,0,0),g=c.getImageData(0,0,d.width,d.height),c.clearRect(0,0, d.width,d.height));a=new Image;a.src=e(this).attr("src");b=1;b=a.width>a.height?d.height/a.height:d.width/a.width;c.drawImage(a,0,0,a.width,a.height,0,0,a.width*b,a.height*b);a=c.getImageData(0,0,d.width,d.height);for(b=0;b<a.data.length;b+=4)a.data[b+3]=g.data[b+3];c.putImageData(a,0,0);d=null});e(i).remove();g=null});return this}})(jQuery);