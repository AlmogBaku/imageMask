/**
 * jQuery imageMask
 * @author Almog Baku - almog.baku@gmail.com
 * @see https://github.com/AlmogBaku/imageMask
 * 
 * @version 0.1b
 * @license MIT License
 */

(function(e){var j=0,c=null,g=null;e.fn.imageMask=function(h){if(void 0==h||!this.is("img"))return!1;var f;h.src?f=h:(f=new Image,f.src=h);var i=this;e(f).load(function(){i.each(function(){var d,a=f;d=e(this);var b;b=d.attr("id")?d.attr("id"):j++;b="imageMask_"+b+"_canvas";c=e("<canvas>").attr({id:b,"class":d.attr("class"),style:d.attr("style"),width:a.width,height:a.height}).insertAfter(d)[0];d=c.getContext("2d");null==g&&(d.drawImage(f,0,0),g=d.getImageData(0,0,c.width,c.height),d.clearRect(0,0, c.width,c.height));a=new Image;a.src=e(this).attr("src");b=1;b=c.width>c.height?c.width/a.width:c.height/a.height;d.drawImage(a,0,0,a.width,a.height,0,0,a.width*b,a.height*b);a=d.getImageData(0,0,c.width,c.height);for(b=0;b<a.data.length;b+=4)a.data[b+3]=g.data[b+3];d.putImageData(a,0,0);c=null});e(i).remove();g=null});return this}})(jQuery);